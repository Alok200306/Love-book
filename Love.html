<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For You ðŸ’—</title>

<style>
body{
  font-family:Georgia,serif;
  background:linear-gradient(180deg,#fff1f5,#fde2e8);
  padding:20px;
}
.box{
  max-width:520px;
  margin:auto;
  background:#fff;
  padding:26px;
  border-radius:20px;
  box-shadow:0 20px 60px rgba(255,105,135,.25);
}
h1{text-align:center;color:#c9184a;font-weight:normal}
.section-title{
  text-align:center;
  color:#8a3b4a;
  font-style:italic;
  margin-top:30px;
}
.shayari{
  background:#fff9fb;
  border-left:3px solid #ff758f;
  padding:16px;
  border-radius:14px;
  margin:14px 0;
  line-height:2;
}
button{
  background:#ff4d6d;
  color:#fff;
  border:none;
  padding:10px 22px;
  border-radius:30px;
}
audio{width:100%;margin-top:10px}
</style>
</head>

<body>

<div class="box" id="lockBox">
  <h1 id="lockTitle">For You ðŸ’—</h1>
  <input id="viewerPassInput" placeholder="Password"
    style="width:100%;padding:10px;border-radius:12px;border:1px solid #f5b7c4">
  <br><br>
  <button onclick="unlockPage()">Open ðŸ’–</button>
</div>

<div class="box" id="contentBox" style="display:none">
  <h1 id="mainTitle">For You ðŸ’—</h1>
  <div id="content"></div>

  <p class="section-title">ðŸŽ§ Kuch baatein sunne me achhi hoti hain</p>
  <audio id="voicePlayer" controls></audio>
</div>

<script type="module">
import { loadPage } from "./firebase.js";

function getEmojiByName(name){
  if(!name) return "ðŸ’—";
  const last = name.toLowerCase().slice(-1);
  if(["a","i","e","y"].includes(last)) return "ðŸŒ¸";
  if(["r","s","n","l"].includes(last)) return "ðŸ¤";
  if(["h","k","m"].includes(last)) return "ðŸ’«";
  if(["o","u"].includes(last)) return "ðŸ’–";
  return "ðŸ’—";
}

window.unlockPage = async function(){
  const pageId = new URLSearchParams(location.search).get("id");
  if(!pageId) return alert("Invalid link");

  const page = await loadPage(pageId);
  if(!page) return alert("Page not found");

  if(viewerPassInput.value !== page.password){
    alert("Wrong password");
    return;
  }

  const emoji = getEmojiByName(page.name);
  lockTitle.innerText = "For " + page.name + " " + emoji;
  mainTitle.innerText = "For " + page.name + " " + emoji;

  lockBox.style.display="none";
  contentBox.style.display="block";

  content.innerHTML="";
  page.shayariData.forEach(s=>{
    content.innerHTML += `
      <h3 class="section-title">${s.heading}</h3>
      <div class="shayari">${s.text.replace(/\n/g,"<br>")}</div>`;
  });

  if(page.voiceURL){
    voicePlayer.src = page.voiceURL;
  }
};
</script>

</body>
</html>
